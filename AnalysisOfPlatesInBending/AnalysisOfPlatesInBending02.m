%**************************************************************%
%                    >> IN THE NAME OF GOD <<                  %
%This program analysis Displacement and Buckling shape mode,   %           
% fix supported in four edgesRectangular Plate in Bending      %
% by finite difference Method.                                 %
%--------------------------------------------------------------%
%      This program is written by salar delavar ghashghaei     %
%              E-mail: salar.d.ghashghaei@gmail.com            %
%**************************************************************%
%                 /\/\/\/\/\/\/\/\/\/\/                        %
%            -   \+-------------------+/           q           %
%            |   /|                   |\    ||||||||||||||||   %
%                \|                   |/    +--------------+   %
%                /|                   |/    /\/\/\F.S/\/\/\/   %
% Y         Ly   \|                   |\    |<-   Lx     ->|   %
% ^              /|                   |/                       %
% |              \|                   |\           q           %
% |          |   /|                   |/    ||||||||||||||||   %
% +-----> X  -   \+-------------------+\    +--------------+   %
% Z               /\/\/\/\/\/\/\/\/\/\/     /\/\/\F.S/\/\/\/   %
%                 |<-      Lx       ->|     |<-   Ly     ->|   %
%**************************************************************%
%             Meshing and node condition
%F.S      F.S     F.S      F.S      F.S      F.S      F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %21     %22      %23      %24      %25      %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %16     %17      %18      %19      %20      %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %11     %12      %13      %14      %15      %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %6      %7       %8       %9       %10      %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %1      %2       %3       %4       %5       %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        %       %        %        %        %        %
%F.S     %F.S    %F.S     %F.S     %F.S     %F.S     %F.S
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clc;clear all;
q=-170;%input('Define q (N):');
Lx=6000;%input('Define Lx (mm):');
Ly=6000;%input('Define Ly (mm):');
h=100;%input('Define h (mm):');
Ny=0.3;%input('Define Ny:');
E=2.1e5;%input('Define E (N/mm^2):');
%%% monitor cpu time
starttime = cputime;
    landaX=Lx/6;landaY=Ly/6;
    for i=1:1:7;
    X=(i-1)*landaX;Y=(i-1)*landaY;   
    x(i)=X;
    y(i)=Y;
    end
%% Finite-difference coefficients
a=(landaX/landaY)^2;N=(E*(h^3))/(12*(1-Ny));
A=6+6*a^2+8*a;B=-4*(1+a);C=-4*a*(1+a);D=2*a;E=a^2;F=1;
%% Equivalent stiffness Matrix
%1      1 2 3 4 5 6 7 8 9 10
k01_10=[4*A B F 0 0 C D 0 0 0];
k01_20=[E 0 0 0 0 0 0 0 0 0];
k00=[0 0 0 0 0];
k01_25=k00;
k1=[k01_10 k01_20 k01_25];
%2      1 2 3 4 5 6 7 8 9 10
k02_10=[B 2*A B F 0 D C D 0 0];
k02_20=[0 E 0 0 0 0 0 0 0 0];
k02_25=k00;
k2=[k02_10 k02_20 k02_25];
%3      1 2 3 4 5 6 7 8 9 10
k03_10=[F B 2*A B F 0 D C D 0];
k03_20=[0 0 E 0 0 0 0 0 0 0];
k03_25=k00;
k3=[k03_10 k03_20 k03_25];
%4      1 2 3 4 5 6 7 8 9 10
k04_10=[0 F B 2*A B 0 0 D C D];
k04_20=[0 0 0 E 0 0 0 0 0 0];
k04_25=k00;
k4=[k04_10 k04_20 k04_25];
%5      1 2 3 4 5 6 7 8 9 10
k05_10=[0 0 F B 4*A 0 0 0 D C];
k05_20=[0 0 0 0 E 0 0 0 0 0];
k05_25=k00;
k5=[k05_10 k05_20 k05_25];
%6      1 2 3 4 5 6 7 8 9 10
k06_10=[C D 0 0 0 2*A B F 0 0];
k06_20=[C D 0 0 0 E 0 0 0 0];
k06_25=k00;
k6=[k06_10 k06_20 k06_25];
%7      1 2 3 4 5 6 7 8 9 10
k07_10=[D C D 0 0 B A B F 0];
k07_20=[D C D 0 0 0 E 0 0 0];
k07_25=k00;
k7=[k07_10 k07_20 k07_25];
%8      1 2 3 4 5 6 7 8 9 10
k08_10=[0 D C D 0 F B A B F];
k08_20=[0 D C D 0 0 0 E 0 0];
k08_25=k00;
k8=[k08_10 k08_20 k08_25];
%9      1 2 3 4 5 6 7 8 9 10
k09_10=[0 0 D C D 0 F B A B];
k09_20=[0 0 D C D 0 0 0 E 0];
k09_25=k00;
k9=[k09_10 k09_20 k09_25];
%10      1 2 3 4 5 6 7 8 9 10
k10_10= [0 0 0 D C 0 0 F B 2*A];
k10_20= [0 0 0 D C 0 0 0 0 E];
k10_25=k00;
k10=[k10_10 k10_20 k10_25];
%11      1 2 3 4 5 6 7 8 9 10
k11_10= [E 0 0 0 0 C D 0 0 0];
k11_20= [2*A B F 0 0 C D 0 0 0];
k11_25= [E 0 0 0 0];
k11=[k11_10 k11_20 k11_25];
%12      1 2 3 4 5 6 7 8 9 10
k12_10= [0 E 0 0 0 D C D 0 0];
k12_20= [B A B F 0 D C D 0 0];
k12_25= [0 E 0 0 0];
k12=[k12_10 k12_20 k12_25];
%13      1 2 3 4 5 6 7 8 9 10
k13_10= [0 0 E 0 0 0 D C D 0];
k13_20= [F B A B F 0 D C D 0];
k13_25= [0 0 E 0 0];
k13=[k13_10 k13_20 k13_25];
%14      1 2 3 4 5 6 7 8 9 10
k14_10= [0 0 0 E 0 0 0 D C D];
k14_20= [0 F B A B 0 0 D C D];
k14_25= [0 0 0 E 0];
k14=[k14_10 k14_20 k14_25];
%15      1 2 3 4 5 6 7 8 9 10
k15_10= [0 0 0 0 E 0 0 0 D C];
k15_20= [0 0 F B 2*A 0 0 0 D C];
k15_25= [0 0 0 0 E];
k15=[k15_10 k15_20 k15_25];
%16      1 2 3 4 5 6 7 8 9 10
k16_10= [0 0 0 0 0 E 0 0 0 0];
k16_20= [C D 0 0 0 2*A B F 0 0];
k16_25= [C D 0 0 0];
k16=[k16_10 k16_20 k16_25];
%17      1 2 3 4 5 6 7 8 9 10
k17_10= [0 0 0 0 0 0 E 0 0 0];
k17_20= [D C D 0 0 B A B F 0];
k17_25= [D C D 0 0];
k17=[k17_10 k17_20 k17_25];
%18      1 2 3 4 5 6 7 8 9 10
k18_10= [0 0 0 0 0 0 0 E 0 0];
k18_20= [0 D C D 0 F B A B F];
k18_25= [0 D C D 0];
k18=[k18_10 k18_20 k18_25];
%19      1 2 3 4 5 6 7 8 9 10
k19_10= [0 0 0 0 0 0 0 0 E 0];
k19_20= [0 0 D C D 0 F B A B];
k19_25= [0 0 D C D];
k19=[k19_10 k19_20 k19_25];
%20      1 2 3 4 5 6 7 8 9 10
k20_10= [0 0 0 0 0 0 0 0 0 E];
k20_20= [0 0 0 D C 0 0 F B 2*A];
k20_25= [0 0 0 D C];
k20=[k20_10 k20_20 k20_25];
%21      1 2 3 4 5 6 7 8 9 10
k21_10= [0 0 0 0 0 0 0 0 0 0];
k21_20= [E 0 0 0 0 C D 0 0 0];
k21_25= [4*A B F 0 0];
k21=[k21_10 k21_20 k21_25];
%22      1 2 3 4 5 6 7 8 9 10
k22_10= [0 0 0 0 0 0 0 0 0 0];
k22_20= [0 E 0 0 0 D C D 0 0];
k22_25= [B 2*A B F 0];
k22=[k22_10 k22_20 k22_25];
%23      1 2 3 4 5 6 7 8 9 10
k23_10= [0 0 0 0 0 0 0 0 0 0];
k23_20= [0 0 E 0 0 0 D C D 0];
k23_25= [F B 2*A B F];
k23=[k23_10 k23_20 k23_25];
%24      1 2 3 4 5 6 7 8 9 10
k24_10= [0 0 0 0 0 0 0 0 0 0];
k24_20= [0 0 0 E 0 0 0 D C D];
k24_25= [0 F B 2*A B];
k24=[k24_10 k24_20 k24_25];
%25      1 2 3 4 5 6 7 8 9 10
k25_10= [0 0 0 0 0 0 0 0 0 0];
k25_20= [0 0 0 0 E 0 0 0 D C];
k25_25= [0 0 F B 4*A];
k25=[k25_10 k25_20 k25_25];
aa=(N/(landaX*landaY));
K=aa*[k1;k2;k3;k4;k5;k6;k7;k8;k9;k10;k11;k12;k13;k14;k15;k16;k17;k18;k19;k20;k21;k22;k23;k24;k25];
F=(q*landaX*landaY)*[1;1;1;1;1;
                     1;1;1;1;1;
                     1;1;1;1;1;
                     1;1;1;1;1;
                     1;1;1;1;1];
if det(K)<0
    disp('-------------------------------------------------------------------')
    disp(' Stiffness matrix is not positive definite. Zero value encountered')
    disp('-------------------------------------------------------------------')
    break
end
%% Displacement
D=inv(K)*F;
o1x=0;o2x=x(2);o3x=x(3);o4x=x(4);o5x=x(5);o6x=x(6);o7x=x(7);
o8x=0;o9x=x(2);o10x=x(3);o11x=x(4);o12x=x(5);o13x=x(6);o14x=x(7);
o15x=0;o16x=x(2);o17x=x(3);o18x=x(4);o19x=x(5);o20x=x(6);o21x=x(7);
o22x=0;o23x=x(2);o24x=x(3);o25x=x(4);o26x=x(5);o27x=x(6);o28x=x(7);
o29x=0;o30x=x(2);o31x=x(3);o32x=x(4);o33x=x(5);o34x=x(6);o35x=x(7);
o36x=0;o37x=x(2);o38x=x(3);o39x=x(4);o40x=x(5);o41x=x(6);o42x=x(7);
o43x=0;o44x=x(2);o45x=x(3);o46x=x(4);o47x=x(5);o48x=x(6);o49x=x(7);
X=[o1x;o2x;o3x;o4x;o5x;o6x;o7x;o8x;o9x;o10x;o11x;o12x;o13x;o14x;o15x;o16x;
    o17x;o18x;o19x;o20x;o21x;o22x;o23x;o24x;o25x;o26x;o27x;o28x;o29x;o30x;o31x;o32x;
    o33x;o34x;o35x;o36x;o37x;o38x;o39x;o40x;o41x;o42x;o43x;o44x;o45x;o46x;o47x;o48x;o49x];
o1y=0;o2y=y(1);o3y=y(1);o4y=y(1);o5y=y(1);o6y=y(1);o7y=y(1);
o8y=y(2);o9y=y(2);o10y=y(2);o11y=y(2);o12y=y(2);o13y=y(2);o14y=y(2);
o15y=y(3);o16y=y(3);o17y=y(3);o18y=y(3);o19y=y(3);o20y=y(3);o21y=y(3);
o22y=y(4);o23y=y(4);o24y=y(4);o25y=y(4);o26y=y(4);o27y=y(4);o28y=y(4);
o29y=y(5);o30y=y(5);o31y=y(5);o32y=y(5);o33y=y(5);o34y=y(5);o35y=y(5);
o36y=y(6);o37y=y(6);o38y=y(6);o39y=y(6);o40y=y(6);o41y=y(6);o42y=y(6);
o43y=y(7);o44y=y(7);o45y=y(7);o46y=y(7);o47y=y(7);o48y=y(7);o49y=y(7);
Y=[o1y;o2y;o3y;o4y;o5y;o6y;o7y;o8y;o9y;o10y;o11y;o12y;o13y;o14y;o15y;o16y;
    o17y;o18y;o19y;o20y;o21y;o22y;o23y;o24y;o25y;o26y;o27y;o28y;o29y;o30y;o31y;o32y;
    o33y;o34y;o35y;o36y;o37y;o38y;o39y;o40y;o41y;o42y;o43y;o44y;o45y;o46y;o47y;o48y;o49y];
Z=[0;0;0;0;0;0;0;0;D(1);D(2);D(3);D(4);D(5);0;0;D(6);D(7);D(8);D(9);D(10);0;0;D(11);D(12);   
   D(13);D(14);D(15);0;0;D(16);D(17);D(18);D(19);D(20);0;0;D(21);D(22);D(23);D(24);D(25);0;0;0;0;0;0;0;0];
X1=[X(1);X(2);X(3);X(4);X(5);X(6);X(7)];Y1=[Y(1);Y(2);Y(3);Y(4);Y(5);Y(6);Y(7)];Z1=[Z(1);Z(2);Z(3);Z(4);Z(5);Z(6);Z(7)];
X2=[X(8);X(9);X(10);X(11);X(12);X(13);X(14)];Y2=[Y(8);Y(9);Y(10);Y(11);Y(12);Y(13);Y(14)];Z2=[Z(8);Z(9);Z(10);Z(11);Z(12);Z(13);Z(14)];
X3=[X(15);X(16);X(17);X(18);X(19);X(20);X(21)];Y3=[Y(15);Y(16);Y(17);Y(18);Y(19);Y(20);Y(21)];Z3=[Z(15);Z(16);Z(17);Z(18);Z(19);Z(20);Z(21)];
X4=[X(22);X(23);X(24);X(25);X(26);X(27);X(28)];Y4=[Y(22);Y(23);Y(24);Y(25);Y(26);Y(27);Y(28)];Z4=[Z(22);Z(23);Z(24);Z(25);Z(26);Z(27);Z(28)];
X5=[X(29);X(30);X(31);X(32);X(33);X(34);X(35)];Y5=[Y(29);Y(30);Y(31);Y(32);Y(33);Y(34);Y(35)];Z5=[Z(29);Z(30);Z(31);Z(32);Z(33);Z(34);Z(35)];
X6=[X(36);X(37);X(38);X(39);X(40);X(41);X(42)];Y6=[Y(36);Y(37);Y(38);Y(39);Y(40);Y(41);Y(42)];Z6=[Z(36);Z(37);Z(38);Z(39);Z(40);Z(41);Z(42)];
X7=[X(43);X(44);X(45);X(46);X(47);X(48);X(49)];Y7=[Y(43);Y(44);Y(45);Y(46);Y(47);Y(48);Y(49)];Z7=[Z(43);Z(44);Z(45);Z(46);Z(47);Z(48);Z(49)];
X8=[X(1);X(8);X(15);X(22);X(29);X(36);X(43)];Y8=[Y(1);X(8);Y(15);Y(22);Y(29);Y(36);Y(43)];Z8=[Z(1);Z(8);Z(15);Z(22);Z(29);Z(36);Z(43)];
X9=[X(2);X(9);X(16);X(23);X(30);X(37);X(44)];Y9=[Y(2);Y(9);Y(16);Y(23);Y(30);Y(37);Y(44)];Z9=[Z(2);Z(9);Z(16);Z(23);Z(30);Z(37);Z(44)];
X10=[X(3);X(10);X(17);X(24);X(31);X(38);X(45)];Y10=[Y(3);Y(10);Y(17);Y(24);Y(31);Y(38);Y(45)];Z10=[Z(3);Z(10);Z(17);Z(24);Z(31);Z(38);Z(45)];
X11=[X(4);X(11);X(18);X(25);X(32);X(39);X(46)];Y11=[Y(4);Y(11);Y(18);Y(25);Y(32);Y(39);Y(46)];Z11=[Z(4);Z(11);Z(18);Z(25);Z(32);Z(39);Z(46)];
X12=[X(5);X(12);X(19);X(26);X(33);X(40);X(47)];Y12=[Y(5);Y(12);Y(19);Y(26);Y(33);Y(40);Y(47)];Z12=[Z(5);Z(12);Z(19);Z(26);Z(33);Z(40);Z(47)];
X13=[X(6);X(13);X(20);X(27);X(34);X(41);X(48)];Y13=[Y(6);Y(13);Y(20);Y(27);Y(34);Y(41);Y(48)];Z13=[Z(6);Z(13);Z(20);Z(27);Z(34);Z(41);Z(48)];
X14=[X(7);X(14);X(21);X(28);X(35);X(42);X(49)];Y14=[Y(7);Y(14);Y(21);Y(28);Y(35);Y(42);Y(49)];Z14=[Z(7);Z(14);Z(21);Z(28);Z(35);Z(42);Z(49)];

%% Ploting
figure(1)
IMAGE=imread('AnalysisOfPlatesInBending.jpg');
image(IMAGE);axis image;axis off;
figure(2)
P1=plot3(X1,Y1,Z1,X2,Y2,Z2,X3,Y3,Z3,X4,Y4,Z4,X5,Y5,Z5,X6,Y6,Z6,X7,Y7,Z7,X8,Y8,Z8,X9,Y9,Z9,X10,Y10,Z10,X11,Y11,Z11,X12,Y12,Z12,X13,Y13,Z13,X14,Y14,Z14);
xlabel('Lx (mm)');ylabel('Ly (mm)');zlabel('Displacement (mm)');set(P1,'LineWidth',5);grid on;
title('Deflection diagram of plate in bending by finite difference method','color','b');
%% -------------------------------------------------------------------
disp('************ Result *************');
disp('===============================');
disp('       X       Y      Delta(z)');
disp('===============================');
disp([X Y Z]);
disp('===============================');
%%%  print time of computation
totaltime = cputime - starttime;
fprintf('\nMax Displacement (mm)= %7.4f \n\n',roundn(min(D),-2))
fprintf('\nTotal time (s)= %7.4f \n\n',totaltime)
disp('*********************************');
